I"U…<h2 id="ä¸€promise">ä¸€ã€Promise</h2>

<h3 id="1æ¦‚è¿°">1.æ¦‚è¿°</h3>

<ul>
  <li>
    <p>æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼ˆå¯¹è±¡ï¼‰ï¼ŒES6æ–°å¢çš„ã€‚</p>
  </li>
  <li>æä¾›äº†ä¸€ç§è§£å†³å¼‚æ­¥çš„æ–¹æ³•ï¼Œè€Œä¸”è§£å†³äº†å›è°ƒåœ°ç‹±çš„é—®é¢˜ã€‚</li>
  <li>ä¸‰ç§çŠ¶æ€ï¼šPendingï¼ˆè¿›è¡Œä¸­ï¼‰ã€Resolvedï¼ˆå·²å®Œæˆï¼‰ã€Rejectedï¼ˆå·²æ‹’ç»ï¼‰</li>
  <li>åŸå‹æ–¹æ³•ï¼šPromise.then / catch /finally</li>
  <li>ç§æœ‰æ–¹æ³•ï¼šresolve / reject</li>
  <li>é™æ€æ–¹æ³•ï¼š all / allsettled / race / any / resolve / reject</li>
</ul>

<ol>
  <li>å½“æŠŠä¸€ä¸ªä»»åŠ¡äº¤ç»™ promise çš„æ—¶å€™ï¼Œå®ƒçš„çŠ¶æ€å°±æ˜¯Pendingï¼Œä»»åŠ¡å®Œæˆä¹‹åçŠ¶æ€å˜ä¸ºResolvedï¼Œæ²¡æœ‰å®Œæˆå¤±è´¥å°±å˜æˆäº†Rejectedã€‚</li>
  <li>ä¸€æ—¦çŠ¶æ€å‘ç”Ÿæ”¹å˜ï¼Œé‚£ä¹ˆå°±ä¸èƒ½æ›´æ”¹çŠ¶æ€äº†ã€‚</li>
</ol>

<h3 id="2-thenè§£å†³å›è°ƒåœ°ç‹±">2. thenï¼ˆè§£å†³å›è°ƒåœ°ç‹±ï¼‰</h3>

<ol>
  <li>then çš„é»˜è®¤è¿”å›å€¼æ˜¯Promiseã€‚</li>
  <li>æˆåŠŸçš„ç»“æœé€šè¿‡ resolve ä¼ é€’ç»™ then ï¼Œä¸‹ä¸€æ¬¡çš„å¼‚æ­¥å¯ä»¥åœ¨ä¸‹ä¸€ä¸ª then ä¸­è¿›è¡Œå¯ä»¥ä¸€ç›´é“¾å¼è°ƒç”¨ã€‚</li>
  <li>then çš„å›è°ƒå‡½æ•°ä¸­å¦‚æœå†™äº† returnï¼Œè¯¥å€¼å½“åš Promise çš„æˆåŠŸç»“æœä¼ é€’ç»™ä¸‹ä¸€ä¸ª then</li>
  <li>å¦‚æœåœ¨ then ä¸­å•ç‹¬è¿”å›ä¸€ä¸ª promise ï¼Œé‚£ä¹ˆä¸‹ä¸€æ¬¡ then çš„æˆåŠŸç»“æœæ¥è‡ªäºä¸Šä¸€ä¸ªthen ä¸­æˆåŠŸå›è°ƒé‡Œé¢è¿”å›çš„ promise çš„ resolve çš„ç»“æœã€‚</li>
  <li>then çš„ä¸­æ–­ï¼šå¯ä»¥é€šè¿‡å›è°ƒä¸­çš„ reject / throw new Error è¿›è¡Œä¸­æ–­ã€‚</li>
</ol>

<h3 id="3-await-async">3. await async</h3>

<ol>
  <li>await ç”¨æ¥ä¿®é¥° promiseã€‚</li>
  <li>async ç”¨æ¥ä¿®é¥° await å°±è¿‘çš„å‡½æ•°ã€‚</li>
  <li>async ä¿®é¥°çš„å‡½æ•°è¿”å›å€¼ä¸º promiseã€‚</li>
  <li>è¢« async ä¿®é¥°çš„å‡½æ•°ä¸€å®šå¯ä»¥è¢« await ä¿®é¥°ã€‚</li>
  <li>æ•è· async å’Œ await ä¸­çš„é”™è¯¯ã€‚
    <ul>
      <li>trycatch æ•è·</li>
      <li>åŸå‹æ–¹æ³• catch æ•è·ï¼šthen().catch()</li>
    </ul>
  </li>
</ol>

<h3 id="4-é™æ€æ–¹æ³•">4. é™æ€æ–¹æ³•</h3>

<ol>
  <li>Promise.allï¼ˆï¼‰
    <ul>
      <li>å¯ä»¥è·å–å¤šä¸ª promise å¤„ç†å¼‚æ­¥çš„ç»“æœï¼Œè¿”å›å€¼æ˜¯ promise</li>
      <li>å¯ä»¥è°ƒç”¨ .thenï¼ˆï¼‰ï¼Œå½“all æ•°ç»„ä¸­æ‰€æœ‰promise éƒ½resolveï¼ˆï¼‰ä¹‹åæ‰æ‰§è¡Œ then ï¼Œåªè¦æœ‰ä¸€ä¸ªrejectï¼ˆï¼‰é‚£ä¹ˆå°±ä¸­æ–­ã€‚</li>
      <li>all çš„then è¿”å›çš„ç»“æœå°±æ˜¯å¯¹åº”çš„ promise è¿”å›çš„æ•°æ®</li>
    </ul>
  </li>
  <li>Promise.allsettledï¼ˆï¼‰
    <ul>
      <li>ä¹Ÿå¯ä»¥è·å–å¤šä¸ª promise å¼‚æ­¥å¤„ç†çš„ç»“æœï¼Œä¸ç®¡ resolve è¿˜æ˜¯ reject éƒ½ä¼šæ‰§è¡Œ then ï¼Œç»“æœè¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæ¯ä¸ªå¯¹è±¡é€šè¿‡ status è®°å½•å¯¹åº” promise çš„çŠ¶æ€ï¼ˆ fulfilled / rejected ï¼‰</li>
    </ul>
  </li>
  <li>Promise.raceï¼ˆï¼‰
    <ul>
      <li>å’Œ all ä¸€æ ·ï¼Œåªè¿”å›ç¬¬ä¸€ä¸ªç»“æœï¼ˆæˆåŠŸæˆ–è€…å¤±è´¥ï¼‰ã€‚</li>
    </ul>
  </li>
  <li>Promise.anyï¼ˆï¼‰
    <ul>
      <li>è¿”å›å¤šä¸ª promise å¤„ç†ç»“æœä¸­ç¬¬ä¸€ä¸ªæˆåŠŸçš„ç»“æœã€‚</li>
    </ul>
  </li>
</ol>

<h3 id="5-generator-å‡½æ•°">5. Generator å‡½æ•°</h3>

<p><strong>æ¦‚å¿µ</strong>ï¼šå¯ä»¥å°†å‡½æ•°çš„æ§åˆ¶æƒäº¤å‡ºï¼ˆå°†å‡½æ•°çš„æ‰§è¡Œæš‚åœï¼‰ï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨å…¶æ›´æ–¹ä¾¿çš„æ§åˆ¶å¼‚æ­¥</p>

<p>æ ¼å¼ï¼šç”¨ * æ¥æ ‡è®° generator å‡½æ•°ï¼Œç”¨ yield æ¥è¿›è¡Œå‡½æ•°æš‚åœï¼ˆäº¤å‡ºæ§åˆ¶æƒï¼‰ã€‚</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="o">*</span><span class="nx">fn</span><span class="err">ï¼ˆï¼‰</span><span class="p">{</span> 
  <span class="c1">//yield äº¤å‡ºæ§åˆ¶æƒ</span>
	<span class="k">yield</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
     <span class="k">yield</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
     <span class="k">return</span> <span class="mi">3</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>é€æ­¥è°ƒç”¨</strong>ï¼š</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">gen</span> <span class="o">=</span> <span class="nx">fn</span><span class="p">()</span>
<span class="nx">gen</span><span class="p">.</span><span class="nx">next</span><span class="p">()</span>
</code></pre></div></div>

<p><strong>å‘å¤–ä¼ é€’æ•°æ®</strong> ï¼šè°ƒç”¨nextï¼ˆï¼‰ä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹è±¡é‡Œæœ‰ä¸¤ä¸ªå±æ€§ï¼Œä¸€ä¸ªæ˜¯valueï¼ˆæ¯æ¬¡çš„è¿”å›å€¼ï¼‰ï¼Œä¸€ä¸ªæ˜¯doneï¼ˆå‡½æ•°æ˜¯å¦æ‰§è¡Œç»“æŸï¼‰</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="o">*</span><span class="nx">fn</span><span class="err">ï¼ˆï¼‰</span><span class="p">{</span> 
	<span class="k">yield</span> <span class="mi">1</span>
     <span class="k">yield</span> <span class="mi">2</span>
     <span class="k">return</span> <span class="mi">3</span>
<span class="p">}</span>
<span class="kd">const</span> <span class="nx">gen</span> <span class="o">=</span> <span class="nx">fn</span><span class="p">()</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">gen</span><span class="p">.</span><span class="nx">next</span><span class="err">ï¼ˆï¼‰</span><span class="p">)</span><span class="c1">//{value:1,done:false}</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">gen</span><span class="p">.</span><span class="nx">next</span><span class="err">ï¼ˆï¼‰</span><span class="p">)</span><span class="c1">//{value:2,done:false}</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">gen</span><span class="p">.</span><span class="nx">next</span><span class="err">ï¼ˆï¼‰</span><span class="p">)</span><span class="c1">//{value:3,done:true}</span>
</code></pre></div></div>

<p><strong>å¤„ç†å¼‚æ­¥</strong>ï¼šé…åˆ promise å¤„ç†</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="o">*</span><span class="nx">fn</span><span class="p">()</span> <span class="p">{</span>
   <span class="k">yield</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">(</span><span class="nx">resolve</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
      <span class="nx">resolve</span><span class="p">()</span>
    <span class="p">},</span> <span class="mi">2000</span><span class="p">)</span>
  <span class="p">})</span>

  <span class="k">yield</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">(</span><span class="nx">resolve</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
      <span class="nx">resolve</span><span class="p">()</span>
    <span class="p">},</span> <span class="mi">1000</span><span class="p">)</span>
  <span class="p">})</span>

  <span class="k">yield</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">(</span><span class="nx">resolve</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
      <span class="nx">resolve</span><span class="p">()</span>
    <span class="p">},</span> <span class="mi">3000</span><span class="p">)</span>
  <span class="p">})</span>
<span class="p">}</span>

<span class="kd">const</span> <span class="nx">gen</span> <span class="o">=</span> <span class="nx">fn</span><span class="p">()</span>
<span class="c1">//è°ƒç”¨ï¼ˆå›è°ƒåœ°ç‹±ï¼‰</span>
<span class="nx">gen</span><span class="p">.</span><span class="nx">next</span><span class="p">().</span><span class="nx">value</span><span class="p">.</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">gen</span><span class="p">.</span><span class="nx">next</span><span class="p">().</span><span class="nx">value</span><span class="p">.</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">gen</span><span class="p">.</span><span class="nx">next</span><span class="p">()</span>
  <span class="p">})</span>
<span class="p">})</span>

<span class="c1">//åˆ©ç”¨co é€’å½’</span>
<span class="kd">function</span> <span class="nx">co</span><span class="p">(</span><span class="nx">gen</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">//res çš„valueå±æ€§é‡Œæ˜¯ä¸€ä¸ª  promise å¯¹è±¡</span>
  <span class="kd">const</span> <span class="nx">res</span> <span class="o">=</span> <span class="nx">gen</span><span class="p">.</span><span class="nx">next</span><span class="p">()</span>
  <span class="c1">//å¦‚æœå‡½æ•°æ‰§è¡Œå®Œæ¯•å°±ç»“æŸé€’å½’</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">done</span><span class="p">)</span> <span class="k">return</span>
  <span class="c1">//æ‹¿åˆ° promise çš„ æˆåŠŸå›è°ƒçš„è¿”å›æ•°æ®</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">co</span><span class="p">(</span><span class="nx">gen</span><span class="p">)</span>
  <span class="p">})</span>
<span class="p">}</span>
</code></pre></div></div>

<p>${\textcolor{red}{asyncã€awaitå’Œgeneratorçš„åŒºåˆ«ï¼š}}$</p>

<p><img src="https://cdn.jsdelivr.net/gh/TCIano/blog_img/async%E3%80%81await%E5%92%8Cgenerator%E5%8C%BA%E5%88%AB.png" alt="asyncã€awaitå’Œgeneratorçš„åŒºåˆ«" /></p>

<h3 id="6-promise-a-è§„èŒƒ">6. Promise A+ è§„èŒƒ</h3>

<p>è§„å®šäº†Promiseå¼€å‘è®¾è®¡æ—¶çš„è§„åˆ™ã€‚</p>

<h3 id="7-æ‰‹å†™-promise-æºç ">7. æ‰‹å†™ Promise æºç </h3>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/*
å°½å¯èƒ½è¿˜åŸ Promise ä¸­çš„æ¯ä¸€ä¸ª API, å¹¶é€šè¿‡æ³¨é‡Šçš„æ–¹å¼æè¿°æ€è·¯å’ŒåŸç†.
*/</span>

<span class="c1">// å®šä¹‰ä¸‰ä¸ªçŠ¶æ€</span>
<span class="kd">const</span> <span class="nx">PENDING</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">PENDING</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">RESOLVED</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">RESOLVED</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">REJECTED</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">REJECTED</span><span class="dl">'</span>
<span class="kd">function</span> <span class="nx">resolvePromise</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">promise2</span><span class="p">,</span> <span class="nx">resolve</span><span class="p">,</span> <span class="nx">reject</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">//åˆ¤æ–­x === promise, æŠ›å‡ºç±»å‹é”™è¯¯</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">x</span> <span class="o">===</span> <span class="nx">promise2</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">======</span><span class="dl">'</span><span class="p">)</span>
    <span class="k">return</span> <span class="nx">reject</span><span class="p">(</span><span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="dl">'</span><span class="s1">ç±»å‹é”™è¯¯</span><span class="dl">'</span><span class="p">))</span>
  <span class="p">}</span>
  <span class="c1">// å…è®¸çŠ¶æ€æ”¹å˜ä¸€æ¬¡</span>
  <span class="kd">let</span> <span class="nx">called</span> <span class="o">=</span> <span class="kc">false</span>

  <span class="k">try</span> <span class="p">{</span>
    <span class="c1">//åˆ¤æ–­xæ˜¯å¦åŒ…å«thenå±æ€§ï¼Œthenable</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">x</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">object</span><span class="dl">'</span> <span class="o">&amp;&amp;</span> <span class="nx">x</span> <span class="o">!==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">then</span> <span class="o">=</span> <span class="nx">x</span><span class="p">.</span><span class="nx">then</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">then</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">function</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// console.log(typeof then)</span>
        <span class="nx">x</span><span class="p">.</span><span class="nx">then</span><span class="p">(</span>
          <span class="nx">x</span><span class="p">,</span>
          <span class="nx">v</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">called</span><span class="p">)</span> <span class="k">return</span>
            <span class="nx">called</span> <span class="o">=</span> <span class="kc">true</span>
            <span class="nx">resolvePromise</span><span class="p">(</span><span class="nx">v</span><span class="p">,</span> <span class="nx">promise2</span><span class="p">,</span> <span class="nx">resolve</span><span class="p">,</span> <span class="nx">reject</span><span class="p">)</span>
          <span class="p">},</span>
          <span class="nx">r</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">called</span><span class="p">)</span> <span class="k">return</span>
            <span class="nx">called</span> <span class="o">=</span> <span class="kc">true</span>
            <span class="nx">reject</span><span class="p">(</span><span class="nx">r</span><span class="p">)</span>
          <span class="p">}</span>
        <span class="p">)</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">called</span><span class="p">)</span> <span class="k">return</span>
        <span class="nx">called</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="nx">resolve</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span>
      <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">called</span><span class="p">)</span> <span class="k">return</span>
      <span class="nx">called</span> <span class="o">=</span> <span class="kc">true</span>
      <span class="nx">resolve</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">called</span><span class="p">)</span> <span class="k">return</span>
    <span class="nx">called</span> <span class="o">=</span> <span class="kc">true</span>
    <span class="nx">reject</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="kd">class</span> <span class="nb">Promise</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="nx">exectuor</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
      <span class="c1">//æ•è·æ‰§è¡Œå™¨é”™è¯¯</span>
      <span class="nx">exectuor</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">resolve</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">reject</span><span class="p">)</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">reject</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="nx">status</span> <span class="o">=</span> <span class="nx">PENDING</span>
  <span class="nx">value</span> <span class="o">=</span> <span class="kc">null</span>
  <span class="nx">reason</span> <span class="o">=</span> <span class="kc">null</span>
  <span class="c1">//å­˜å‚¨å¤±è´¥å’ŒæˆåŠŸçš„å›è°ƒ</span>
  <span class="nx">onFullFilledCallbacks</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="nx">onRejectedCallbacks</span> <span class="o">=</span> <span class="p">[]</span>

  <span class="kd">static</span> <span class="nx">all</span><span class="p">(</span><span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">,</span> <span class="nx">reject</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">args</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">prev</span><span class="p">,</span> <span class="nx">curr</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">arr</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">curr</span> <span class="k">instanceof</span> <span class="nb">Promise</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">curr</span><span class="p">.</span><span class="nx">then</span><span class="p">(</span>
            <span class="nx">v</span> <span class="o">=&gt;</span> <span class="p">{</span>
              <span class="nx">prev</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">v</span>
              <span class="k">if</span> <span class="p">(</span><span class="nx">prev</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">resolve</span><span class="p">(</span><span class="nx">prev</span><span class="p">)</span>
              <span class="p">}</span>
            <span class="p">},</span>
            <span class="nx">r</span> <span class="o">=&gt;</span> <span class="p">{</span>
              <span class="nx">reject</span><span class="p">(</span><span class="nx">r</span><span class="p">)</span>
            <span class="p">}</span>
          <span class="p">)</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="nx">prev</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">curr</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">prev</span>
      <span class="p">},</span> <span class="p">[])</span>
    <span class="p">})</span>
  <span class="p">}</span>
  <span class="kd">static</span> <span class="nx">resolve</span><span class="p">(</span><span class="nx">v</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">v</span> <span class="k">instanceof</span> <span class="nb">Promise</span><span class="p">)</span> <span class="k">return</span> <span class="nx">v</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">,</span> <span class="nx">reject</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">resolve</span><span class="p">(</span><span class="nx">v</span><span class="p">))</span>
  <span class="p">}</span>
  <span class="kd">static</span> <span class="nx">reject</span><span class="p">(</span><span class="nx">r</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">,</span> <span class="nx">reject</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">reject</span><span class="p">(</span><span class="nx">r</span><span class="p">)</span>
    <span class="p">})</span>
  <span class="p">}</span>
  <span class="kd">static</span> <span class="nx">allSettled</span><span class="p">(</span><span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">,</span> <span class="nx">reject</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="kd">function</span> <span class="nx">addData</span><span class="p">(</span><span class="nx">prev</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">prev</span><span class="p">[</span><span class="nx">index</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">prev</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="nx">args</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">resolve</span><span class="p">(</span><span class="nx">prev</span><span class="p">)</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="nx">args</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">prev</span><span class="p">,</span> <span class="nx">curr</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">arr</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">curr</span> <span class="k">instanceof</span> <span class="nb">Promise</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">curr</span><span class="p">.</span><span class="nx">then</span><span class="p">(</span>
            <span class="nx">res</span> <span class="o">=&gt;</span> <span class="p">{</span>
              <span class="nx">addData</span><span class="p">(</span><span class="nx">prev</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="p">{</span>
                <span class="na">value</span><span class="p">:</span> <span class="nx">res</span><span class="p">,</span>
                <span class="na">status</span><span class="p">:</span> <span class="dl">'</span><span class="s1">fulfilled</span><span class="dl">'</span>
              <span class="p">})</span>
            <span class="p">},</span>
            <span class="nx">r</span> <span class="o">=&gt;</span> <span class="p">{</span>
              <span class="nx">addData</span><span class="p">(</span><span class="nx">prev</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="p">{</span>
                <span class="na">reason</span><span class="p">:</span> <span class="nx">r</span><span class="p">,</span>
                <span class="na">status</span><span class="p">:</span> <span class="dl">'</span><span class="s1">rejected</span><span class="dl">'</span>
              <span class="p">})</span>
            <span class="p">}</span>
          <span class="p">)</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="nx">addData</span><span class="p">(</span><span class="nx">prev</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="p">{</span>
            <span class="na">reason</span><span class="p">:</span> <span class="nx">curr</span><span class="p">,</span>
            <span class="na">status</span><span class="p">:</span> <span class="dl">'</span><span class="s1">fulfilled</span><span class="dl">'</span>
          <span class="p">})</span>
        <span class="p">}</span>
      <span class="p">})</span>
    <span class="p">})</span>
  <span class="p">}</span>

  <span class="kd">static</span> <span class="nx">race</span><span class="p">(</span><span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">,</span> <span class="nx">reject</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">args</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">item</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">item</span> <span class="k">instanceof</span> <span class="nb">Promise</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">item</span><span class="p">.</span><span class="nx">then</span><span class="p">(</span>
            <span class="nx">v</span> <span class="o">=&gt;</span> <span class="p">{</span>
              <span class="nx">resolve</span><span class="p">(</span><span class="nx">v</span><span class="p">)</span>
            <span class="p">},</span>
            <span class="nx">r</span> <span class="o">=&gt;</span> <span class="p">{</span>
              <span class="nx">reject</span><span class="p">(</span><span class="nx">r</span><span class="p">)</span>
            <span class="p">}</span>
          <span class="p">)</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="nx">resolve</span><span class="p">(</span><span class="nx">item</span><span class="p">)</span>
        <span class="p">}</span>
      <span class="p">})</span>
    <span class="p">})</span>
  <span class="p">}</span>

  <span class="k">finally</span><span class="p">(</span><span class="nx">cb</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">then</span><span class="p">(</span>
      <span class="nx">v</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">cb</span><span class="p">()).</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">v</span><span class="p">)</span>
      <span class="p">},</span>
      <span class="nx">r</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">cb</span><span class="p">()).</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="k">throw</span> <span class="nx">r</span>
        <span class="p">})</span>
      <span class="p">}</span>
    <span class="p">)</span>
  <span class="p">}</span>

  <span class="nx">resolve</span> <span class="o">=</span> <span class="nx">v</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">//åªæœ‰çŠ¶æ€ä¸ºpendingæ‰æ‰§è¡Œ</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">status</span> <span class="o">===</span> <span class="nx">PENDING</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">status</span> <span class="o">=</span> <span class="nx">RESOLVED</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">v</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">onFullFilledCallbacks</span><span class="p">)</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">onFullFilledCallbacks</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">c</span> <span class="o">=&gt;</span> <span class="nx">c</span><span class="p">())</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="nx">reject</span> <span class="o">=</span> <span class="nx">r</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">status</span> <span class="o">===</span> <span class="nx">PENDING</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">status</span> <span class="o">=</span> <span class="nx">REJECTED</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">reason</span> <span class="o">=</span> <span class="nx">r</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">onRejectedCallbacks</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">c</span> <span class="o">=&gt;</span> <span class="nx">c</span><span class="p">())</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="nx">then</span><span class="p">(</span><span class="nx">onFullFilled</span><span class="p">,</span> <span class="nx">onRejected</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">debugger</span>
    <span class="c1">//onFullFilled onRejectedç±»å‹åˆ¤æ–­</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">onFullFilled</span> <span class="o">!==</span> <span class="dl">'</span><span class="s1">function</span><span class="dl">'</span><span class="p">)</span> <span class="nx">onFullFilled</span> <span class="o">=</span> <span class="nx">v</span> <span class="o">=&gt;</span> <span class="nx">v</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">onFullFilled</span> <span class="o">!==</span> <span class="dl">'</span><span class="s1">function</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">onRejected</span> <span class="o">=</span> <span class="nx">r</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">throw</span> <span class="nx">r</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="kd">const</span> <span class="nx">promise2</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">,</span> <span class="nx">reject</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">status</span> <span class="o">===</span> <span class="nx">RESOLVED</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Promiseä¸ºå¾®ä»»åŠ¡ï¼Œæ‰€ä»¥æ”¾åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—æ‰§è¡Œ</span>
        <span class="nx">queueMicrotask</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="k">try</span> <span class="p">{</span>
            <span class="kd">const</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">onFullFilled</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span>
            <span class="nx">resolvePromise</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">promise2</span><span class="p">,</span> <span class="nx">resolve</span><span class="p">,</span> <span class="nx">reject</span><span class="p">)</span>
          <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">reject</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span>
          <span class="p">}</span>
        <span class="p">})</span>
      <span class="p">}</span>

      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">status</span> <span class="o">===</span> <span class="nx">REJECTED</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">queueMicrotask</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="k">try</span> <span class="p">{</span>
            <span class="kd">const</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">onRejected</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">reason</span><span class="p">)</span>
            <span class="nx">resolvePromise</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">promise2</span><span class="p">,</span> <span class="nx">resolve</span><span class="p">,</span> <span class="nx">reject</span><span class="p">)</span>
          <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">reject</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span>
          <span class="p">}</span>
        <span class="p">})</span>
      <span class="p">}</span>

      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">status</span> <span class="o">===</span> <span class="nx">PENDING</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">//å¦‚æœçŠ¶æ€ä¸ºpendingï¼Œåˆ™æ‰§è¡Œæ–¹æ³•æ”¾å…¥æ•°ç»„ä¸­ï¼Œç­‰å¾…resolveæˆ–rejectæ—¶å€™æ‰§è¡Œ</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">onFullFilledCallbacks</span><span class="p">.</span><span class="nx">push</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="nx">queueMicrotask</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="k">try</span> <span class="p">{</span>
              <span class="kd">const</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">onFullFilled</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span>
              <span class="nx">resolvePromise</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">promise2</span><span class="p">,</span> <span class="nx">resolve</span><span class="p">,</span> <span class="nx">reject</span><span class="p">)</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
              <span class="nx">reject</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span>
            <span class="p">}</span>
          <span class="p">})</span>
        <span class="p">})</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">onRejectedCallbacks</span><span class="p">.</span><span class="nx">push</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="nx">queueMicrotask</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="k">try</span> <span class="p">{</span>
              <span class="kd">const</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">onRejected</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">reason</span><span class="p">)</span>
              <span class="nx">resolvePromise</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">promise2</span><span class="p">,</span> <span class="nx">resolve</span><span class="p">,</span> <span class="nx">reject</span><span class="p">)</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
              <span class="nx">reject</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span>
            <span class="p">}</span>
          <span class="p">})</span>
        <span class="p">})</span>
      <span class="p">}</span>
    <span class="p">})</span>
    <span class="k">return</span> <span class="nx">promise2</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nb">Promise</span><span class="p">.</span><span class="nx">deferred</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="p">{}</span>
  <span class="nx">result</span><span class="p">.</span><span class="nx">promise</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">resolve</span><span class="p">,</span> <span class="nx">reject</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">result</span><span class="p">.</span><span class="nx">resolve</span> <span class="o">=</span> <span class="nx">resolve</span>
    <span class="nx">result</span><span class="p">.</span><span class="nx">reject</span> <span class="o">=</span> <span class="nx">reject</span>
  <span class="p">})</span>

  <span class="k">return</span> <span class="nx">result</span>
<span class="p">}</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nb">Promise</span>

</code></pre></div></div>

<p><strong><code class="language-plaintext highlighter-rouge">resolvePromise()</code></strong> æºç åˆ†æ</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// åˆ¤æ–­ x æ˜¯ä¸æ˜¯å¯¹è±¡ å¹¶ä¸”ä¸æ˜¯null</span>
<span class="c1">// x æ˜¯ return new Promise((resolve, reject) =&gt; {resolve(2)})</span>
<span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">x</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">object</span><span class="dl">'</span> <span class="o">&amp;&amp;</span> <span class="nx">x</span> <span class="o">!==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// å¦‚æœæ˜¯å¯¹è±¡ xæ˜¯å¦æœ‰thenæ–¹æ³•</span>
  <span class="kd">const</span> <span class="nx">then</span> <span class="o">=</span> <span class="nx">x</span><span class="p">.</span><span class="nx">then</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">then</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">function</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// console.log(typeof then)</span>
    <span class="c1">// æ‰‹åŠ¨è¿”å›çš„promise.then</span>
    <span class="nx">x</span><span class="p">.</span><span class="nx">then</span><span class="p">(</span>
      <span class="nx">v</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">called</span><span class="p">)</span> <span class="k">return</span>
        <span class="nx">called</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="c1">// æœ‰å¯èƒ½æ‰‹åŠ¨è¿”å›çš„promiseä¸­çš„resolveè¿˜æœ‰å¯èƒ½ç»§ç»­è¿”å›Promise</span>
        <span class="nx">resolvePromise</span><span class="p">(</span><span class="nx">v</span><span class="p">,</span> <span class="nx">promise2</span><span class="p">,</span> <span class="nx">resolve</span><span class="p">,</span> <span class="nx">reject</span><span class="p">)</span>
      <span class="p">},</span>
      <span class="nx">r</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">called</span><span class="p">)</span> <span class="k">return</span>
        <span class="nx">called</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="nx">reject</span><span class="p">(</span><span class="nx">r</span><span class="p">)</span>
      <span class="p">}</span>
    <span class="p">)</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">called</span><span class="p">)</span> <span class="k">return</span>
    <span class="nx">called</span> <span class="o">=</span> <span class="kc">true</span>
    <span class="c1">// é»˜è®¤è¿”å›promiseçš„resolve</span>
    <span class="c1">// æ—¢ç„¶èµ°åˆ°äº†è¿™é‡Œ x ä¸æ˜¯promise é‚£xå°±åº”è¯¥æºå¸¦åˆ°ä¸‹ä¸€ä¸ªthenä¸­</span>
    <span class="nx">resolve</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">called</span><span class="p">)</span> <span class="k">return</span>
  <span class="nx">called</span> <span class="o">=</span> <span class="kc">true</span>
  <span class="c1">// x ä¸æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œç›´æ¥è°ƒç”¨resolve(x) ä¼ é€’åˆ°ä¸‹ä¸€ä¸ªthenä¸­</span>
  <span class="nx">resolve</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="8-æºç åˆ†æ">8. æºç åˆ†æ</h3>

<ol>
  <li>åˆå§‹åŒ–</li>
</ol>

<ul>
  <li>ç”¨ <code class="language-plaintext highlighter-rouge">status</code> æ¥å­˜å‚¨å½“å‰ promise çš„çŠ¶æ€ã€‚</li>
  <li>ç”¨<code class="language-plaintext highlighter-rouge">value</code>å­˜æˆåŠŸçš„ç»“æœå€¼ï¼Œç”¨<code class="language-plaintext highlighter-rouge">resson</code>å­˜å¤±è´¥çš„ç»“æœå€¼ã€‚</li>
  <li>ç”¨${\textcolor{red}{æ•°ç»„}}$åˆ†åˆ«å­˜å‚¨æˆåŠŸå’Œå¤±è´¥çš„å›è°ƒï¼Œå› ä¸ºpromiseå®ä¾‹å¯ä»¥å¤šæ¬¡è°ƒç”¨ then ã€‚</li>
  <li>åˆå§‹åŒ– Promise ä¸­çš„ resolveå’Œreject å›è°ƒæ–¹æ³•ã€‚</li>
</ul>

<ol>
  <li>æ‰§è¡Œæ„é€ å‡½æ•°</li>
</ol>

<ul>
  <li>æŠŠ Promise ä¸­ä¼ é€’çš„å‚æ•°é€šè¿‡<code class="language-plaintext highlighter-rouge">executor</code> è¿›è¡Œæ¥æ”¶ï¼Œé€šè¿‡ trycatch è¿›è¡Œæ•è·ï¼Œå¦‚æœä¼ é€’çš„å‚æ•°ä¸æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå°±è¿›è¡Œæ•è·ï¼Œè°ƒç”¨<code class="language-plaintext highlighter-rouge">reject()</code>ç§æœ‰æ–¹æ³•ã€‚</li>
  <li>å¦‚æœæ­£å¸¸æ‰§è¡Œï¼Œé‚£ä¹ˆå°±è°ƒç”¨<code class="language-plaintext highlighter-rouge">executor()</code>æ–¹æ³•ï¼Œå¹¶ä¸”æŠŠç§æœ‰æ–¹æ³•ä¼ é€’è¿‡å»ã€‚å› æ­¤ Promise ä¸­çš„å‡½æ•°æ˜¯åŒæ­¥çš„ã€‚</li>
</ul>

<ol>
  <li>è°ƒç”¨<code class="language-plaintext highlighter-rouge">resolve()</code></li>
</ol>

<ul>
  <li>å½“ Promise ä¸­è°ƒç”¨<code class="language-plaintext highlighter-rouge">resolve()</code> å¹¶ä¸”ä¼ é€’äº†ä¸€ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆå°±ä¼šè°ƒç”¨ç±»ä¸­çš„ç§æœ‰æ–¹æ³•ï¼Œå¹¶ä¸”å…ˆåˆ¤æ–­æ˜¯å¦å¤„äº Pedding çŠ¶æ€ï¼Œå¤„äºæ‰å¯ä»¥æ‰§è¡Œï¼Œè°ƒç”¨<code class="language-plaintext highlighter-rouge">resolve()</code> çš„promiseä¼šæŠŠpeddingçŠ¶æ€å˜ä¸º resolvedçŠ¶æ€ï¼Œå› æ­¤æ˜¯ä¸å¯é€†çš„ï¼Œç„¶åä¼šæŠŠä¼ é€’æ¥çš„å‚æ•°ï¼Œå­˜å‚¨åˆ°æˆåŠŸçš„ç»“æœå€¼ä¸­ï¼Œæ¥ç€ä¼šæ‰§è¡ŒæˆåŠŸå›è°ƒæ•°ç»„é‡Œçš„å›è°ƒå‡½æ•°ã€‚</li>
</ul>

<ol>
  <li>è°ƒç”¨ <code class="language-plaintext highlighter-rouge">then()</code> æ‰§è¡Œå¼‚æ­¥</li>
</ol>

<ul>
  <li>ä¼ é€’<code class="language-plaintext highlighter-rouge">then()</code> ä¸­çš„å‚æ•°ï¼Œç„¶ååœ¨ç±»ä¸­æ‹¿åˆ°å‚æ•°å¹¶ä¸”åˆ¤æ–­è¯¥å‚æ•°æ˜¯å¦ä¸ºå‡½æ•°ï¼Œä¸æ˜¯å‡½æ•°ç»™è¯¥å‚æ•°åŒ…è£…ä¸ºä¸€ä¸ªå‡½æ•°ï¼Œä¸ºäº†ä¿è¯<code class="language-plaintext highlighter-rouge">then()</code>çš„é“¾å¼è°ƒç”¨æ€§ï¼Œåˆ™éœ€è¦åœ¨å†…éƒ¨é‡æ–°å®ä¾‹åŒ–ä¸€ä¸ª promise2  ï¼Œç»§ç»­åœ¨å†…éƒ¨åˆ¤æ–­å½“å‰promise2 çš„çŠ¶æ€ï¼Œæœ€åreturn promise2ã€‚</li>
  <li>å¦‚æœå½“å‰çŠ¶æ€ä¸º Resolve ï¼Œåˆ™é€šè¿‡<code class="language-plaintext highlighter-rouge">queueMicrotask()</code> ä¸­è°ƒç”¨<code class="language-plaintext highlighter-rouge">onFullFill()</code> ä¼ é€’æˆåŠŸçš„è¿”å›å€¼ï¼ˆvalueï¼‰ï¼Œåˆ™åœ¨å¤–éƒ¨çš„ then ä¸­å°±èƒ½æ‹¿åˆ°æˆåŠŸçš„è¿”å›å€¼ã€‚ï¼ˆä¸ºäº†ç¡®ä¿thenä¸­çš„å›è°ƒæ˜¯å¼‚æ­¥çš„ä»¥åŠæ˜¯ä¸€ä¸ªå¾®ä»»åŠ¡ï¼ŒA+è§„èŒƒåªè§„å®šäº†thenéœ€è¦æ˜¯ä¸€ä¸ªå¼‚æ­¥ä¸­å¹¶æ²¡æœ‰è§„å®šthenä¸­å¿…é¡»ä¸ºå¾®ä»»åŠ¡ï¼Œæ‰€ä»¥setTimeout()ä¹Ÿå¯ä»¥ï¼‰</li>
  <li>å¦‚æœçŠ¶æ€ä¸º padding åˆ™æŠŠæ–¹æ³•æ”¾å…¥åˆ°å›è°ƒæ•°ç»„ä¸­ï¼Œç­‰å¾…resolveæˆ–è€…æ˜¯rejectçš„æ‰§è¡Œï¼Œä»è€Œç»§ç»­æ‰§è¡Œå›è°ƒæ•°ç»„ä¸­çš„å›è°ƒã€‚</li>
</ul>

<ol>
  <li>then ä¸­æ‰‹åŠ¨è¿”å› promise</li>
</ol>

<ul>
  <li>å¦‚æœåœ¨ then ä¸­ç»§ç»­ return promiseæˆ–è€… return ä¸€ä¸ªæ•°æ® ï¼Œåˆ™ä¼šè°ƒç”¨<code class="language-plaintext highlighter-rouge">resolvePromise()</code> å¾—åˆ°<code class="language-plaintext highlighter-rouge">onFullFill()</code> çš„è¿”å›å€¼ï¼Œåœ¨å†…éƒ¨åˆ¤æ–­è¿”å›å€¼ã€‚
    <ul>
      <li>å¦‚æœè¿”å›å€¼æ˜¯ promise ï¼Œé‚£å°±ç»§ç»­è°ƒç”¨ <code class="language-plaintext highlighter-rouge">then</code> ç»§ç»­é€’å½’ï¼Œç›´åˆ°è¿”å›å€¼ä¸æ˜¯promiseã€‚</li>
      <li>å¦‚æœè¿”å›å€¼ä¸æ˜¯promiseé‚£ä¹ˆå°±è°ƒç”¨  é»˜è®¤çš„å†…éƒ¨çš„ promise å†…ç½®çš„ <code class="language-plaintext highlighter-rouge">resolve()</code> ä¼ é€’åˆ°ä¸‹ä¸€ä¸ª then ä¸­ã€‚</li>
    </ul>
  </li>
</ul>

<h2 id="äºŒåŒæ­¥å¼‚æ­¥">äºŒã€åŒæ­¥å¼‚æ­¥</h2>

<h3 id="1-æ¦‚å¿µ">1. æ¦‚å¿µ</h3>

<ul>
  <li><strong>å¼‚æ­¥ä»»åŠ¡ï¼š</strong>å› ä¸º JS æ˜¯å•çº¿ç¨‹çš„ï¼ŒåŒä¸€æ—¶é—´åªèƒ½æ‰§è¡Œä¸€ä¸ªä»»åŠ¡ï¼Œå½“æˆ‘ä»¬æ‰§è¡Œä¸€ä¸ªæ¯”è¾ƒè€—æ—¶çš„ä»»åŠ¡çš„æ—¶å€™ï¼Œå°±ä¼šé˜»å¡ä¸‹é¢çš„ä»»åŠ¡ï¼Œæ­¤æ—¶ JS å°±ä¼šæŠŠè€—æ—¶ä»»åŠ¡å§”æ‰˜ç»™å®¿ä¸»å½“å®¿ä¸»ç¯å¢ƒæ‰§è¡Œï¼Œå½“å®¿ä¸»ç¯å¢ƒæ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œç„¶åæŠŠå›è°ƒäº¤ç»™ JS æ‰§è¡Œï¼Œè¿™äº›äº¤ç»™å®¿ä¸»ç¯å¢ƒæ‰§è¡Œçš„è€—æ—¶ä»»åŠ¡å°±æ˜¯å¼‚æ­¥ä»»åŠ¡ã€‚</li>
  <li><strong>åŒæ­¥ä»»åŠ¡ï¼š</strong>åœ¨ä¸»çº¿ç¨‹ä¸Šæ‰§è¡Œçš„ï¼Œå½“å‰ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œæ‰èƒ½æ‰§è¡Œåä¸€ä¸ªä»»åŠ¡ã€‚</li>
</ul>

<h3 id="2-æ‰§è¡Œæµç¨‹">2. æ‰§è¡Œæµç¨‹</h3>

<ul>
  <li>ä¸»çº¿ç¨‹å…ˆåˆ¤æ–­ä»»åŠ¡çš„ç±»å‹
    <ul>
      <li>å¦‚æœä¸ºåŒæ­¥ä»»åŠ¡ï¼Œé‚£ä¹ˆå°±å…ˆæ‰§è¡Œã€‚</li>
      <li>å¦‚æœä¸ºå¼‚æ­¥ä»»åŠ¡ï¼Œé‚£ä¹ˆä¼šäº¤ç»™å®¿ä¸»ç¯å¢ƒæ‰§è¡Œ</li>
    </ul>
  </li>
  <li>å½“å®¿ä¸»ç¯å¢ƒæ¯æ‰§è¡Œä¸€ä¸ªå¼‚æ­¥ï¼Œä¼šæŠŠè¿™ä¸ªå¼‚æ­¥çš„å›è°ƒæ”¾å…¥ä»»åŠ¡é˜Ÿåˆ—ä¸­ã€‚</li>
  <li>å½“ä¸»çº¿ç¨‹çš„å…¨éƒ¨ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œä¼šå–ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ï¼Œå–ä»»åŠ¡ä¹Ÿä¼šä¾æ¬¡å–å…ˆè¿›æ¥çš„ä»»åŠ¡ã€‚</li>
  <li>ä»»åŠ¡é˜Ÿåˆ—å–å‡ºæ¥çš„ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œå†ç»§ç»­å–ä¸€ä¸‹ä¸ªï¼Œé‡å¤çš„ä»ä»»åŠ¡é˜Ÿåˆ—ä¸­å‹å…¥æ‰§è¡Œæ ˆçš„æ“ä½œç§°ä¹‹ä¸º EventLoop äº‹ä»¶å¾ªç¯ã€‚</li>
</ul>

<h3 id="3-å®ä»»åŠ¡">3. å®ä»»åŠ¡</h3>

<p>ç”±å®¿ä¸»ç¯å¢ƒå‘èµ·çš„å¼‚æ­¥ä»»åŠ¡ã€‚</p>

<p>setTimeOutã€setIntervalã€scriptä»£ç å—</p>

<h3 id="4-å¾®ä»»åŠ¡">4. å¾®ä»»åŠ¡</h3>

<p>ç”± javascript è‡ªèº«å‘èµ·çš„ä»»åŠ¡ã€‚</p>

<p>.thenï¼ˆï¼‰ã€catchï¼ˆï¼‰ã€MutationObserver</p>

<h3 id="5-å®ä»»åŠ¡å¾®ä»»åŠ¡æ‰§è¡Œé¡ºåº">5. å®ä»»åŠ¡ã€å¾®ä»»åŠ¡æ‰§è¡Œé¡ºåº</h3>

<ul>
  <li>æ•´ä¸ª script å½“åšä¸€ä¸ªå®ä»»åŠ¡</li>
  <li>å…ˆæ‰§è¡Œå®ä»»åŠ¡</li>
  <li>æŸ¥çœ‹ä»»åŠ¡é˜Ÿåˆ—æ˜¯å¦æœ‰å¾®ä»»åŠ¡ï¼Œ
    <ul>
      <li>å¦‚æœæœ‰å¾®ä»»åŠ¡ï¼Œé‚£ä¹ˆå°±å…ˆæ‰§è¡Œå®Œæ‰€æœ‰é˜Ÿåˆ—ä¸­çš„å¾®ä»»åŠ¡ã€‚</li>
      <li>å¦‚æœæ²¡æœ‰å¾®ä»»åŠ¡ï¼Œé‚£ä¹ˆå°±æ‰§è¡Œä¸‹ä¸€ä¸ªå®ä»»åŠ¡ã€‚</li>
    </ul>
  </li>
</ul>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">async</span> <span class="kd">function</span> <span class="nx">async1</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">async1 start</span><span class="dl">'</span><span class="p">)</span>
  <span class="k">await</span> <span class="nx">async2</span><span class="p">()</span>
  <span class="c1">// awaitåé¢çš„ä»£ç å¯ä»¥ç†è§£ä¸ºpromise.then(function(){ å›è°ƒæ‰§è¡Œçš„ })</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">async1 end</span><span class="dl">'</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">async</span> <span class="kd">function</span> <span class="nx">async2</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">async2</span><span class="dl">'</span><span class="p">)</span>
<span class="p">}</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">script start</span><span class="dl">'</span><span class="p">)</span>
<span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">setTimeout</span><span class="dl">'</span><span class="p">)</span>
<span class="p">},</span> <span class="mi">0</span><span class="p">)</span>

<span class="nx">async1</span><span class="p">()</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">script end</span><span class="dl">'</span><span class="p">)</span>

<span class="c1">// script startã€async1 startã€async2ã€script endã€async1 end'ã€setTimeout</span>

</code></pre></div></div>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	<span class="kd">const</span> <span class="nx">async1</span> <span class="o">=</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">async1</span><span class="dl">'</span><span class="p">)</span>
        <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">timer1</span><span class="dl">'</span><span class="p">)</span>
        <span class="p">},</span> <span class="mi">2000</span><span class="p">)</span>
       
        <span class="k">await</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">promise1</span><span class="dl">'</span><span class="p">)</span>
          <span class="c1">// resolve()</span>
        <span class="p">})</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">async1 end</span><span class="dl">'</span><span class="p">)</span>
        <span class="k">return</span> <span class="dl">'</span><span class="s1">async1 success</span><span class="dl">'</span>
      <span class="p">}</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">script start</span><span class="dl">'</span><span class="p">)</span>
      <span class="nx">async1</span><span class="p">().</span><span class="nx">then</span><span class="p">((</span><span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">res</span><span class="p">))</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">script end</span><span class="dl">'</span><span class="p">)</span>
      <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
        <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">res</span><span class="p">))</span>
      <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">timer2</span><span class="dl">'</span><span class="p">)</span>
      <span class="p">},</span> <span class="mi">1000</span><span class="p">)</span>
      
 <span class="c1">//script startã€async1ã€promise1ã€script endã€1ã€timer2ã€timer1</span>
</code></pre></div></div>

<h2 id="ä¸‰-é—­åŒ…">ä¸‰ ã€é—­åŒ…</h2>

<h3 id="1-æ¦‚å¿µ-1">1. æ¦‚å¿µ</h3>

<ul>
  <li>å¯ä»¥åœ¨ä¸€ä¸ªå†…å±‚å‡½æ•°ä¸­å¯ä»¥è®¿é—®åˆ°å¤–å±‚å‡½æ•°çš„ä½œç”¨åŸŸã€‚</li>
</ul>

<h3 id="2-åŸç†">2. åŸç†</h3>

<ul>
  <li>æ ¸å¿ƒå…¶å®æ˜¯ä½œç”¨åŸŸé“¾ï¼Œå½“æˆ‘ä»¬åœ¨å½“å‰ä½œç”¨åŸŸè®¿é—®ä¸åˆ°æ•°æ®çš„æ—¶å€™ï¼Œå°±å‘çˆ¶çº§è®¿é—®ï¼Œå¦‚æœçˆ¶çº§ä¹Ÿæ²¡æœ‰ï¼Œé‚£ä¹ˆå°±ç»§ç»­ å‘å¤–è®¿é—®ï¼Œä¸€ç›´æ‰¾åˆ°æ‰¾åˆ°å…¨å±€ã€‚</li>
</ul>

<h3 id="3-ä½œç”¨">3. ä½œç”¨</h3>

<ul>
  <li>æ•°æ®ç§æœ‰åŒ–ï¼Œé˜²æ­¢æ±¡æŸ“å…¨å±€
    <ul>
      <li>å½“æˆ‘ä»¬åœ¨å±€éƒ¨å®šä¹‰çš„æ•°æ®å’Œå…¨å±€çš„å˜é‡å†²çªæ—¶ï¼Œé—­åŒ…ä¼šæŠŠæˆ‘ä»¬åœ¨å†…éƒ¨å£°æ˜çš„å˜é‡ä¿ç•™åœ¨è¯¥èŒƒå›´ä¹‹å†…ï¼Œä¸ä¼šå½±å“å¤–éƒ¨çš„å˜é‡ï¼Œé¿å…äº†æ±¡æŸ“å…¨å±€å˜é‡çš„å¯èƒ½æ€§ã€‚</li>
    </ul>
  </li>
</ul>

<h3 id="4-ç¼ºç‚¹">4. ç¼ºç‚¹</h3>

<ul>
  <li>å¦‚æœä½¿ç”¨ä¸å½“çš„è¯å¯èƒ½é€ æˆå†…å­˜æ³„æ¼ï¼Œæ¯”å¦‚æˆ‘ä»¬çš„å†…éƒ¨å‡½æ•°çš„æ‰§è¡Œéœ€è¦å¤–éƒ¨å‡½æ•°é‡Œé¢çš„å˜é‡ï¼Œå½“å‡½æ•°è°ƒç”¨å®Œæ¯•ä¹‹åï¼Œä½†æ˜¯å¤–éƒ¨å‡½æ•°ä¸­çš„å˜é‡è¿˜ä¸€ç›´å­˜åœ¨äºå†…å­˜ä¸­ï¼Œæ²¡æœ‰è¢«å›æ”¶ï¼Œè¿™å°±å¯¼è‡´äº†å†…å­˜æ³„æ¼çš„å¯èƒ½ã€‚</li>
  <li>å› æ­¤æˆ‘ä»¬éœ€è¦åœ¨å‡½æ•°è°ƒç”¨ç»“æŸä¹‹åæŠŠä¸ä½¿ç”¨çš„å˜é‡æ‰‹åŠ¨åˆ é™¤æˆ–è€…ç½®ç©º ã€‚</li>
</ul>

<h2 id="å››åƒåœ¾å›æ”¶æœºåˆ¶">å››ã€åƒåœ¾å›æ”¶æœºåˆ¶</h2>

<h3 id="1-æ¦‚å¿µ-2">1. æ¦‚å¿µ</h3>

<p>js å†…å­˜æ˜¯è‡ªåŠ¨è¿›è¡Œåˆ†é…å’Œå›æ”¶ï¼Œå†…å­˜åœ¨ä¸ä½¿ç”¨çš„æ—¶å€™ä¼šè¢«åƒåœ¾å›æ”¶è‡ªåŠ¨å›æ”¶ï¼Œå½“ç„¶è¿˜æœ‰ä¸€äº›æƒ…å†µä¸‹ï¼Œå†…å­˜æ— æ³•å›æ”¶ï¼Œæ¯”å¦‚ï¼ˆä½¿ç”¨é—­åŒ…ä¸å½“çš„è¯ï¼‰ï¼Œè¿™æ—¶å€™å°±éœ€è¦æ‰‹åŠ¨çš„å›æ”¶ã€‚</p>

<h3 id="2-ç”Ÿå‘½å‘¨æœŸ">2. ç”Ÿå‘½å‘¨æœŸ</h3>

<p>ä¸»è¦ä¸ºä¸‰ä¸ªé˜¶æ®µ</p>

<ul>
  <li>å†…å­˜åˆ›å»ºåˆ†é…ï¼šå½“å‰é˜¶æ®µè¿›è¡Œå˜é‡ã€å¯¹è±¡ã€å‡½æ•°å†…å­˜çš„ç”³è¯·</li>
  <li>å†…å­˜ä½¿ç”¨ï¼šå¯¹å†…å­˜è¿›è¡Œè¯»å†™çš„é˜¶æ®µï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨å˜é‡ã€å‡½æ•°æˆ–è€…å¯¹è±¡</li>
  <li>å†…å­˜é”€æ¯ï¼šå½“å˜é‡ã€å‡½æ•°å’Œå¯¹è±¡ä¸å†ä½¿ç”¨ï¼Œå°±ä¼šè¢«åƒåœ¾å›æ”¶è‡ªåŠ¨å›æ”¶ã€‚</li>
</ul>

<h3 id="3-ç®—æ³•">3. ç®—æ³•</h3>

<ul>
  <li>
    <p>å¼•ç”¨è®¡æ•°</p>

    <ul>
      <li>è®¡ç®—å½“å‰å†…å­˜è¢«å¼•ç”¨çš„æ¬¡æ•°ï¼Œå†…å­˜è¢«å¼•ç”¨ä¸€æ¬¡é‚£ä¹ˆè®¡æ•°+1ï¼Œä¸è¢«å¼•ç”¨è®¡æ•°-1ï¼Œå½“è®¡æ•°ä¸º0çš„æ—¶å€™ï¼Œå°±é‡Šæ”¾å†…å­˜ã€‚</li>
      <li><strong>ç¼ºç‚¹ï¼š</strong>å½“ä¸¤ä¸ªå†…å­˜å¾ªç¯å¼•ç”¨çš„æ—¶å€™ï¼Œä¹Ÿå°±è¯´æ˜ä¸¤ä¸ªå†…å­˜çš„å¼•ç”¨è®¡æ•°éƒ½ä¸ä¸º0ï¼Œä»–ä»¬çš„å†…å­˜ä¸ä¼šè¢«é”€æ¯ï¼Œå°±é€ æˆäº†å†…å­˜æ³„æ¼ã€‚</li>
    </ul>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">fn</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="p">{}</span>
  <span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="p">{}</span>
  <span class="nx">a</span><span class="p">.</span><span class="nx">a1</span> <span class="o">=</span> <span class="nx">b</span>
  <span class="nx">b</span><span class="p">.</span><span class="nx">b1</span> <span class="o">=</span> <span class="nx">a</span>
<span class="p">}</span>

<span class="nx">fn</span><span class="p">()</span>
<span class="c1">//è°ƒç”¨å®Œä¹‹å a ã€b ç›¸äº’å¼•ç”¨ï¼Œæ¬¡æ•°éƒ½ä¸º 1 ä¸ä¼šè¢«é”€æ¯ã€‚</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>æ ‡è®°æ¸…é™¤</p>

    <ul>
      <li>é€šè¿‡å…¨å±€ï¼ˆæ ¹èŠ‚ç‚¹ï¼‰æ ‡è®°æ‰€æœ‰ä»æ ¹èŠ‚ç‚¹å¼€å§‹èƒ½å¤Ÿè®¿é—®åˆ°çš„å¯¹è±¡ï¼Œæœªè¢«æ ‡è®°çš„å¯¹è±¡æœ€ç»ˆä¼šè¢«æ¸…é™¤ã€‚</li>
    </ul>
  </li>
</ul>

<h2 id="äº”æ•°æ®ç±»å‹ä»¥åŠç±»å‹æ£€æµ‹">äº”ã€æ•°æ®ç±»å‹ä»¥åŠç±»å‹æ£€æµ‹</h2>

<h3 id="1-æ•°æ®ç±»å‹">1. æ•°æ®ç±»å‹</h3>

<ul>
  <li>åŸºæœ¬æ•°æ®ç±»å‹ï¼ˆå€¼ç±»å‹ï¼‰ï¼šå­—ç¬¦ä¸²ï¼ˆStringï¼‰ã€æ•°å­—ï¼ˆNumberï¼‰ã€å¸ƒå°”ï¼ˆBooleanï¼‰ã€ç©º ï¼ˆNullï¼‰ã€æœªå®šä¹‰ï¼ˆundefinedï¼‰ã€Symbolã€bigIntã€‚</li>
  <li>å¼•ç”¨æ•°æ®ç±»å‹ï¼ˆå¯¹è±¡ç±»å‹ï¼‰ï¼šå¯¹è±¡ï¼ˆObjectï¼‰ã€æ•°å­—ï¼ˆArrayï¼‰ã€å‡½æ•°ï¼ˆFunctionï¼‰ã€æ­£åˆ™ï¼ˆRegExpï¼‰ã€æ—¥æœŸï¼ˆDateï¼‰</li>
</ul>

<h3 id="2-æ•°æ®ç±»å‹çš„æ£€æµ‹">2. æ•°æ®ç±»å‹çš„æ£€æµ‹</h3>

<blockquote>
  <p><strong>type of</strong></p>
</blockquote>

<p>æ­£å¸¸æ£€æµ‹å‡ºï¼šNumberã€Booleanã€Stringã€Functionã€Undefinedã€Symbolã€BigInt</p>

<ul>
  <li>æ£€æµ‹åŸºæœ¬æ•°æ®ç±»å‹ï¼šNullä¼šè¿”å›Objectï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ªç©ºçš„å¯¹è±¡å¼•ç”¨ã€‚</li>
  <li>æ£€æµ‹å¼•ç”¨æ•°æ®ç±»å‹ï¼šé™¤Functionä¹‹å¤–ï¼Œéƒ½è¿”å›Objectã€‚</li>
</ul>

<blockquote>
  <p><strong>Null å’Œ Undefined çš„åŒºåˆ«ï¼Ÿ</strong></p>
</blockquote>

<ul>
  <li>Null æ˜¯å®šä¹‰äº†ä¸€ä¸ªç©ºå¯¹è±¡çš„å¼•ç”¨ã€‚</li>
  <li>Undefined æ˜¯æœªå®šä¹‰ã€‚</li>
</ul>

<blockquote>
  <p><strong>instanceof</strong></p>
</blockquote>

<p>ç”¨äºæ£€æµ‹æ„é€ å‡½æ•°çš„ <strong><code class="language-plaintext highlighter-rouge">prototype</code></strong> å±æ€§æ˜¯å¦å‡ºç°åœ¨å®ä¾‹å¯¹è±¡çš„åŸå‹é“¾ä¸Šã€‚</p>

<ul>
  <li>åªèƒ½è¿›è¡Œå•ä¸€çš„æ£€æµ‹ï¼Œåˆ¤æ–­æŸä¸ªæ•°æ®æ˜¯ä¸æ˜¯æŸä¸ªæ•°æ®ç±»å‹ã€‚</li>
</ul>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//åˆ¤æ–­å®ä¾‹å¯¹è±¡æ˜¯å¦å¯ä»¥æ ¹æ®åŸå‹é“¾æ‰¾åˆ°å¯¹åº”çš„æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡</span>
      <span class="kd">const</span> <span class="nx">_instanceof</span> <span class="o">=</span> <span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">Fn</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="c1">// è¡¥å…¨ä»£ç </span>
        <span class="kd">let</span> <span class="nx">targetProto</span> <span class="o">=</span> <span class="nx">target</span><span class="p">.</span><span class="nx">__proto__</span><span class="p">;</span>
        <span class="kd">let</span> <span class="nx">fnProto</span> <span class="o">=</span> <span class="nx">Fn</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">targetProto</span><span class="p">,</span> <span class="nx">fnProto</span><span class="p">);</span>
        <span class="k">while</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">targetProto</span> <span class="o">==</span> <span class="nx">fnProto</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">targetProto</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="nx">targetProto</span> <span class="o">=</span> <span class="nx">targetProto</span><span class="p">.</span><span class="nx">__proto__</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">};</span>
      <span class="kd">let</span> <span class="nx">arr</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">();</span>
      <span class="nx">str</span> <span class="o">=</span> <span class="dl">""</span><span class="p">;</span>
      <span class="c1">// console.log(arr);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">arr</span><span class="p">);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arr</span> <span class="k">instanceof</span> <span class="nb">Array</span><span class="p">,</span> <span class="nx">_instanceof</span><span class="p">(</span><span class="nx">arr</span><span class="p">,</span> <span class="nb">Array</span><span class="p">));</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">str</span> <span class="k">instanceof</span> <span class="nb">Array</span><span class="p">,</span> <span class="nx">_instanceof</span><span class="p">(</span><span class="nx">str</span><span class="p">,</span> <span class="nb">Array</span><span class="p">));</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arr</span> <span class="k">instanceof</span> <span class="nb">Object</span><span class="p">,</span> <span class="nx">_instanceof</span><span class="p">(</span><span class="nx">arr</span><span class="p">,</span> <span class="nb">Object</span><span class="p">));</span>
</code></pre></div></div>

<blockquote>
  <p><strong>toString</strong></p>
</blockquote>

<p>å®ƒæ˜¯ Object çš„åŸå‹æ–¹æ³•ï¼Œè°ƒç”¨å®ƒä¼šè¿”å›å½“å‰å¯¹è±¡çš„<code class="language-plaintext highlighter-rouge">[[Class]]</code>ã€‚ä¼šè¿”å›[[object xxx]]ï¼Œxxxå°±æ˜¯æ•°æ®ç±»å‹ã€‚</p>

<ul>
  <li>å¦‚æœæ•°ç»„è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œæ˜¯ä¸ä¼šè¿”å›ä»–çš„æ•°æ®ç±»å‹çš„ï¼Œå› ä¸ºè¿™ä¸ªæ–¹æ³•ç›¸å½“äºç”¨äº†è‡ªå·±åŸå‹ä¸Šçš„æ–¹æ³•ï¼Œè€Œä¸æ˜¯ObjectåŸå‹ä¸Šçš„ã€‚</li>
  <li>æ­¤æ—¶éœ€è¦å€Ÿè°ƒè¿™ä¸ªæ–¹æ³•
    <ul>
      <li>é€šè¿‡<code class="language-plaintext highlighter-rouge">Object.prototype.toString.call(æ•°æ®)</code>ï¼Œé€šè¿‡ call æ”¹å˜ this æŒ‡å‘ï¼Œè®© toString çš„this æŒ‡å‘è¦åˆ¤æ–­çš„æ•°æ®ã€‚</li>
    </ul>
  </li>
</ul>

<blockquote>
  <p><strong>constructor</strong></p>
</blockquote>

<p><code class="language-plaintext highlighter-rouge">constructor</code>æœ¬è´¨æ˜¯å¯¹å‡½æ•°æœ¬èº«çš„å¼•ç”¨ã€‚å¯ä»¥æ£€æµ‹ç”±å­—é¢é‡æ–¹å¼åˆ›å»ºå‡ºæ¥çš„æ•°æ®ç±»å‹ã€‚å› ä¸ºæˆ‘ä»¬å¯ä»¥é€šè¿‡å®ä¾‹çš„åŸå‹æ‰¾åˆ°å®ƒçš„ constructor ï¼Œè€Œconstructorå°±æ˜¯æ„é€ å‡½æ•°æœ¬äº‹ ï¼Œå­—é¢é‡æ–¹å¼çš„æœ¬è´¨å°±æ˜¯åˆ›å»ºäº†ä¸€ä¸ªè¿™ä¸ªå¯¹è±¡çš„å®ä¾‹ã€‚å› æ­¤å°±å¯ä»¥åˆ¤æ–­è¿™ä¸ªå®ä¾‹æ˜¯ä¸æ˜¯ç”±è¯¥æ„é€ ç±»å‹åˆ›å»ºçš„ã€‚</p>

<blockquote>
  <p><strong>isArray()</strong></p>
</blockquote>

<p>ç”¨æ¥æ£€æµ‹æ˜¯å¦ä¸ºæ•°ç»„</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[];</span>
<span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">arr</span><span class="p">);</span><span class="c1">//true</span>
</code></pre></div></div>

<h3 id="3-setå’Œmapæ•°æ®ç»“æ„">3. Setå’ŒMapæ•°æ®ç»“æ„</h3>

<ul>
  <li>Setï¼ˆç±»ä¼¼äºæ•°ç»„ï¼‰</li>
</ul>

<p>ç‰¹ç‚¹ï¼šæˆå‘˜çš„å€¼å”¯ä¸€ï¼Œæ²¡æœ‰é‡å¤çš„å€¼ï¼Œå¯ä»¥ç”¨æ¥æ•°ç»„å»é‡ï¼Œ[â€¦new Set(array)]ï¼Œå¯ä»¥æ¥å—æ•°ç»„æˆ–è€…ä¼ªæ•°ç»„ä½œä¸ºå‚æ•°ã€‚</p>

<p>å£°æ˜ï¼šnew Setï¼ˆï¼‰</p>

<p>${\textcolor{red}{æ–¹æ³•}}$ï¼šæ·»åŠ æˆå‘˜ï¼šaddï¼ˆï¼‰</p>

<p>â€‹    		åˆ¤æ–­æˆå‘˜æ˜¯å¦å­˜åœ¨ï¼šhasï¼ˆï¼‰</p>

   		 åˆ é™¤æˆå‘˜è¿”å›å¸ƒå°”ï¼šdeleteï¼ˆï¼‰

   		 æ¸…é™¤setï¼šclearï¼ˆï¼‰

<p>â€‹    		éå†setï¼šforeachï¼ˆï¼‰</p>

<ul>
  <li>WeakSetï¼ˆå’ŒSetç±»ä¼¼ï¼‰</li>
</ul>

<p>ç‰¹ç‚¹ï¼šé¦–å…ˆæˆå‘˜åªèƒ½æ˜¯å¯¹è±¡ï¼Œå…¶æ¬¡WeakSet ä¸­çš„å¯¹è±¡éƒ½æ˜¯å¼±å¼•ç”¨ï¼Œå³åƒåœ¾å›æ”¶æœºåˆ¶ä¸è€ƒè™‘ WeakSet å¯¹è¯¥å¯¹è±¡çš„å¼•ç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœå…¶ä»–å¯¹è±¡éƒ½ä¸å†å¼•ç”¨è¯¥å¯¹è±¡ï¼Œé‚£ä¹ˆåƒåœ¾å›æ”¶æœºåˆ¶ä¼šè‡ªåŠ¨å›æ”¶è¯¥å¯¹è±¡æ‰€å ç”¨çš„å†…å­˜ï¼Œä¸è€ƒè™‘è¯¥å¯¹è±¡è¿˜å­˜åœ¨äº WeakSet ä¹‹ä¸­ã€‚</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>let ws = new WeakSet();
      ws.add({
        name: "å¼ ä¸‰",
        age: 18,
      });
      ws.add({
        name: "æå››",
        age: 20,
      });
      console.log(ws);
</code></pre></div></div>

<p><img src="https://cdn.jsdelivr.net/gh/TCIano/blog_img/202208301137623.png" alt="img" /></p>

<ul>
  <li>Map(åƒå¯¹è±¡ï¼Œä½†æ˜¯é”®ï¼ˆkeyï¼‰èƒ½ä¸ºä»»æ„ç±»å‹çš„å€¼)</li>
</ul>

<p>å£°æ˜ï¼šnew Mapï¼ˆï¼‰</p>

<p>${\textcolor{red}{æ–¹æ³•}}$ï¼šæ·»åŠ æˆå‘˜ï¼šsetï¼ˆkeyï¼Œvalueï¼‰</p>

   		 åˆ¤æ–­æˆå‘˜æ˜¯å¦å­˜åœ¨ï¼šhas(key)

   		  è·å–æˆå‘˜çš„å€¼ï¼šgetï¼ˆkeyï¼‰

   		   åˆ é™¤æˆå‘˜ ï¼šdeleteï¼ˆkeyï¼‰

   		  è¿”å›Mapç»“æ„æˆå‘˜ï¼šsize

   	 	 æ¸…é™¤æ‰€æœ‰æˆå‘˜ï¼Œæ²¡æœ‰è¿”å›å€¼ï¼šclearï¼ˆï¼‰

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>let o = {
        userm: "wer",
      };
      let map = new Map();
      map.set(o, "age");
      console.log(map.get(o));
      console.log(map.has(o));
      //   map.delete(o);
      console.log(map);
</code></pre></div></div>

<p><img src="https://cdn.jsdelivr.net/gh/TCIano/blog_img/202208301137312.png" alt="img" /></p>

<ul>
  <li>WeakMapï¼ˆï¼‰</li>
</ul>

<p>WeakMapåªæ¥å—å¯¹è±¡ä½œä¸ºé”®åï¼ˆnullé™¤å¤–ï¼‰ï¼Œä¸æ¥å—å…¶ä»–ç±»å‹çš„å€¼ä½œä¸ºé”®åã€‚</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// WeakMap å¯ä»¥ä½¿ç”¨ set æ–¹æ³•æ·»åŠ æˆå‘˜
const wm1 = new WeakMap();
const key = {foo: 1};
wm1.set(key, 2);
wm1.get(key) // 2

// WeakMap ä¹Ÿå¯ä»¥æ¥å—ä¸€ä¸ªæ•°ç»„ï¼Œ
// ä½œä¸ºæ„é€ å‡½æ•°çš„å‚æ•°
const k1 = [1, 2, 3];
const k2 = [4, 5, 6];
const wm2 = new WeakMap([[k1, 'foo'], [k2, 'bar']]);
wm2.get(k2) // "bar"
</code></pre></div></div>

<h3 id="4-string-å’Œ-tostring-çš„åŒºåˆ«">4. String å’Œ toString çš„åŒºåˆ«</h3>

<ol>
  <li>String å¯ä»¥å°†æ‰€æœ‰çš„æ•°æ®éƒ½è½¬åŒ–ä¸ºå­—ç¬¦ä¸²ï¼Œä½†æ˜¯ toString() ä¸èƒ½å¯¹nullå’Œundefinedè¿›è¡Œè½¬æ¢</li>
</ol>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
    <span class="kd">var</span> <span class="nx">str1</span> <span class="o">=</span> <span class="kc">false</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span>
    <span class="kd">var</span> <span class="nx">str2</span> <span class="o">=</span> <span class="nb">String</span><span class="p">(</span><span class="nx">flase</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">str1</span><span class="p">,</span><span class="k">typeof</span> <span class="nx">str1</span> <span class="p">);</span><span class="c1">//false string</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">str2</span><span class="p">,</span><span class="k">typeof</span> <span class="nx">str2</span> <span class="p">);</span><span class="c1">//false string</span>
<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></code></pre></div></div>

<ol>
  <li>ä½¿ç”¨ toString() å¯¹æ•°å­—è¿›è¡Œè½¬æ¢çš„æ—¶å€™å¯ä»¥é€šè¿‡åœ¨æ‹¬å·ä¸­æ·»åŠ æ•°å­—ï¼Œæ¥å°†æ•°å­—è½¬æ¢ä¸ºç›¸åº”çš„è¿›åˆ¶,ä½†æ˜¯ä½¿ç”¨ String() ä¸èƒ½è¿›è¡Œè¿›åˆ¶è½¬æ¢ã€‚</li>
</ol>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
    <span class="kd">var</span> <span class="nx">str1</span> <span class="o">=</span> <span class="nb">String</span><span class="p">(</span><span class="kc">undefined</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">str1</span><span class="p">,</span><span class="k">typeof</span> <span class="nx">str1</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">str2</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">str2</span><span class="p">,</span><span class="k">typeof</span> <span class="nx">str2</span><span class="p">);</span>
 <span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></code></pre></div></div>

<h2 id="å…­ç»§æ‰¿">å…­ã€ç»§æ‰¿</h2>

<h3 id="1-åŸå‹é“¾ç»§æ‰¿">1. åŸå‹é“¾ç»§æ‰¿</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      <span class="kd">function</span> <span class="nx">Father</span><span class="p">(</span><span class="nx">uname</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">uanme</span> <span class="o">=</span> <span class="nx">uname</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">some</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">yiixe</span><span class="dl">"</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">arr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">];</span>
      <span class="p">}</span>
      <span class="c1">//æŠŠå‡½æ•°çš„æ–¹æ³•å®šä¹‰åˆ° åŸå‹ ä¸Š</span>
      <span class="nx">Father</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">work</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">å·¥ä½œ</span><span class="dl">"</span><span class="p">);</span>
      <span class="p">};</span>

      <span class="kd">function</span> <span class="nx">Son</span><span class="p">(</span><span class="nx">uname</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">uanme</span> <span class="o">=</span> <span class="nx">uname</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="nx">Son</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Father</span><span class="p">();</span>
      <span class="c1">//è¿™æ · Sonçš„åŸå‹é‡Œå°±æ²¡æœ‰äº†æ„é€ å‡½æ•°</span>
      <span class="nx">Son</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="kd">constructor</span> <span class="o">=</span> <span class="nx">Son</span><span class="p">;</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">Son</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span> <span class="c1">//Father</span>

      <span class="nx">Son</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">study</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">å­¦ä¹ </span><span class="dl">"</span><span class="p">);</span>
      <span class="p">};</span>

      <span class="kd">let</span> <span class="nx">father</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Father</span><span class="p">(</span><span class="dl">"</span><span class="s2">çˆ¶ç±»1</span><span class="dl">"</span><span class="p">);</span>
      <span class="kd">let</span> <span class="nx">father2</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Father</span><span class="p">(</span><span class="dl">"</span><span class="s2">çˆ¶ç±»2</span><span class="dl">"</span><span class="p">);</span>
      <span class="nx">father</span><span class="p">.</span><span class="nx">work</span><span class="p">();</span> <span class="c1">//å·¥ä½œ</span>
      <span class="nx">father2</span><span class="p">.</span><span class="nx">work</span><span class="p">();</span> <span class="c1">//å·¥ä½œ</span>

      <span class="kd">let</span> <span class="nx">son</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Son</span><span class="p">(</span><span class="dl">"</span><span class="s2">å­ç±»</span><span class="dl">"</span><span class="p">);</span>
      <span class="kd">let</span> <span class="nx">son1</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Son</span><span class="p">(</span><span class="dl">"</span><span class="s2">å­ç±»1</span><span class="dl">"</span><span class="p">);</span>
      <span class="nx">son</span><span class="p">.</span><span class="nx">study</span><span class="p">();</span> <span class="c1">//å­¦ä¹ </span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">son</span><span class="p">.</span><span class="nx">arr</span><span class="p">);</span> <span class="c1">//[1,2,3,4]</span>
      <span class="nx">son</span><span class="p">.</span><span class="nx">arr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">son1</span><span class="p">.</span><span class="nx">arr</span><span class="p">);</span> <span class="c1">//[1,2,3,4,5]</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">father</span><span class="p">.</span><span class="nx">arr</span><span class="p">);</span> <span class="c1">//[1,2,3,4]</span>
      <span class="nx">son1</span><span class="p">.</span><span class="nx">arr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">];</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">son1</span><span class="p">.</span><span class="nx">arr</span><span class="p">);</span> <span class="c1">//[1,2]</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">father</span><span class="p">.</span><span class="nx">arr</span><span class="p">);</span> <span class="c1">//[1,2,3,4]</span>
</code></pre></div></div>

<p><strong>ç¼ºç‚¹ï¼š</strong></p>

<ul>
  <li>å¦‚æœFatherå®šä¹‰äº†ä¸€ä¸ªå¼•ç”¨ç±»å‹çš„å±æ€§ï¼ŒSon.prototype = new Fatherï¼ˆï¼‰ç›¸å½“äº Son.prototype å˜æˆäº† Fatherçš„ä¸€ä¸ªå®ä¾‹å¯¹è±¡ï¼Œä»è€Œç›¸å½“äºåˆ›å»ºäº†Son.prototype.å¼•ç”¨ç±»å‹ è¿™ä¸ªå±æ€§ ï¼Œæœ€åSonçš„æ‰€æœ‰å®ä¾‹éƒ½ä¼šé€šè¿‡åœ°å€è®¿é—®è¿™ä¸ªå±æ€§çš„å†…å®¹ï¼Œå¦‚æœå¯¹è¯¥å¼•ç”¨ç±»å‹å±æ€§è¿›è¡Œä¿®æ”¹ï¼Œåˆ™å…¶ä»–çš„å®ä¾‹è®¿é—®çš„è¯¥å¼•ç”¨ç±»å‹çš„å†…å®¹éƒ½ä¼šæ”¹å˜ã€‚</li>
  <li>åŸå‹é“¾çš„ç¬¬äºŒä¸ªé—®é¢˜æ˜¯ï¼Œå­ç±»å‹åœ¨å®ä¾‹åŒ–æ—¶ä¸å…è®¸ç»™çˆ¶ç±»å‹çš„æ„é€ å‡½æ•°ä¼ å‚ï¼Œè¿™æ ·åšä¸ç¬¦åˆé¢å‘å¯¹è±¡ç¼–ç¨‹çš„è§„åˆ™ï¼šå¯¹è±¡ï¼ˆå®ä¾‹ï¼‰æ‰æ˜¯å±æ€§çš„æ‹¥æœ‰è€…ã€‚å¦‚æœåœ¨å­ç±»å®šä¹‰æ—¶å°±å°†å±æ€§èµ‹äº†å€¼ï¼Œå°±å˜æˆäº†ç±»æ‹¥æœ‰å±æ€§ï¼Œè€Œä¸æ˜¯å¯¹è±¡æ‹¥æœ‰å±æ€§äº†ã€‚</li>
  <li>ç»™å­ç±»å‹çš„åŸå‹æ·»åŠ å±æ€§å’Œæ–¹æ³•å¿…é¡»åœ¨æ›¿æ¢åŸå‹ä¹‹åã€‚</li>
  <li>å­ç±»å‹çš„åŸå‹çš„æ„é€ å‡½æ•°è¢«ç ´åè¦†ç›–ã€‚éœ€è¦æˆ‘ä»¬é‡æ–°æ‰‹åŠ¨æŠŠåˆ›å»ºconstructorå¹¶ä¸”æŠŠå­ç±»å‹çš„æ„é€ å‡½æ•°æŒ‡å‘å­ç±»å‹ã€‚</li>
</ul>

<h3 id="2-å€Ÿç”¨æ„é€ å‡½æ•°ç»§æ‰¿">2. å€Ÿç”¨æ„é€ å‡½æ•°ç»§æ‰¿</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">Father</span><span class="p">(</span><span class="nx">uname</span><span class="p">,</span> <span class="nx">age</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">uname</span> <span class="o">=</span> <span class="nx">uname</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">age</span> <span class="o">=</span> <span class="nx">age</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">work</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">å·¥ä½œ</span><span class="dl">"</span><span class="p">);</span>
        <span class="p">};</span>
      <span class="p">}</span>

      <span class="kd">function</span> <span class="nx">Son</span><span class="p">(</span><span class="nx">uname</span><span class="p">,</span> <span class="nx">age</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">Father</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span> <span class="c1">//è®©çˆ¶ç±»å‹çš„thisæŒ‡å‘å­ç±»</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">uname</span> <span class="o">=</span> <span class="nx">uname</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">age</span> <span class="o">=</span> <span class="nx">age</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">study</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">å­¦ä¹ </span><span class="dl">"</span><span class="p">);</span>
        <span class="p">};</span>
      <span class="p">}</span>

      <span class="kd">let</span> <span class="nx">father</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Father</span><span class="p">(</span><span class="dl">"</span><span class="s2">çˆ¶ç±»</span><span class="dl">"</span><span class="p">,</span> <span class="mi">30</span><span class="p">);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">father</span><span class="p">.</span><span class="nx">age</span><span class="p">);</span>
      <span class="nx">father</span><span class="p">.</span><span class="nx">work</span><span class="p">();</span><span class="c1">// å·¥ä½œ</span>
      <span class="nx">father</span><span class="p">.</span><span class="nx">__proto__</span><span class="p">.</span><span class="nx">work1</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">å†å·¥ä½œ</span><span class="dl">"</span><span class="p">);</span>
      <span class="p">};</span>
      <span class="nx">father</span><span class="p">.</span><span class="nx">work1</span><span class="p">();</span><span class="c1">// å†å·¥ä½œ</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">===========</span><span class="dl">"</span><span class="p">);</span>
      <span class="kd">let</span> <span class="nx">son</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Son</span><span class="p">(</span><span class="dl">"</span><span class="s2">å„¿å­</span><span class="dl">"</span><span class="p">,</span> <span class="mi">18</span><span class="p">);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">son</span><span class="p">.</span><span class="nx">uname</span><span class="p">,</span> <span class="nx">son</span><span class="p">.</span><span class="nx">age</span><span class="p">);</span><span class="c1">// ç”·ï¼Œ18</span>
      <span class="nx">son</span><span class="p">.</span><span class="nx">gender</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">ç”·</span><span class="dl">"</span><span class="p">;</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">son</span><span class="p">.</span><span class="nx">gender</span><span class="p">);</span><span class="c1">// ç”·</span>
      <span class="nx">son</span><span class="p">.</span><span class="nx">study</span><span class="p">();</span><span class="c1">// å­¦ä¹ </span>
      <span class="nx">son</span><span class="p">.</span><span class="nx">work</span><span class="p">();</span><span class="c1">// å·¥ä½œ </span>
      <span class="nx">son</span><span class="p">.</span><span class="nx">work1</span><span class="p">();</span><span class="c1">//work1 not  defined</span>
</code></pre></div></div>

<p><strong>ç¼ºç‚¹ï¼š</strong></p>

<ul>
  <li>æ‰€æœ‰æ–¹æ³•éƒ½å®šä¹‰åœ¨æ„é€ å‡½æ•°ä¸­ï¼Œæ— æ³•åšåˆ°å‡½æ•°å¤ç”¨ï¼Œçˆ¶ç±»åŸå‹ä¸­å®šä¹‰çš„æ–¹æ³•ï¼Œå­ç±»è®¿é—®ä¸åˆ°ï¼Œå› ä¸ºå­ç±»çš„å®ä¾‹åªç»§æ‰¿äº†çˆ¶ç±»çš„å®ä¾‹å±æ€§/æ–¹æ³•ï¼Œæ²¡æœ‰ç»§æ‰¿çˆ¶ç±»åŸå‹å¯¹è±¡ä¸­çš„å±æ€§/æ–¹æ³•ã€‚</li>
</ul>

<h3 id="3-ç»„åˆå¼ç»§æ‰¿">3. ç»„åˆå¼ç»§æ‰¿</h3>

<ul>
  <li>åŸå‹é“¾å’Œå€Ÿç”¨æ„é€ å‡½æ•°çš„æŠ€æœ¯ç»„åˆåˆ°ä¸€å—ã€‚</li>
  <li>ä½¿ç”¨åŸå‹é“¾å®ç°å¯¹åŸå‹æ–¹æ³•çš„ç»§æ‰¿ï¼Œè€Œé€šè¿‡æ„é€ å‡½æ•°æ¥å®ç°å¯¹å±æ€§çš„ç»§æ‰¿ã€‚æ—¢é€šè¿‡åœ¨åŸå‹ä¸Šå®šä¹‰æ–¹æ³•å®ç°äº†å‡½æ•°å¤ç”¨ï¼Œåˆèƒ½å¤Ÿä¿è¯æ¯ä¸ªå®ä¾‹éƒ½æœ‰å®ƒè‡ªå·±çš„å±æ€§ã€‚</li>
</ul>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// åˆ›å»ºäººçš„ç±»</span>
<span class="kd">function</span> <span class="nx">Person</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">age</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">age</span> <span class="o">=</span> <span class="nx">age</span>
<span class="p">}</span>

<span class="nx">Person</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">say</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">è¯´è¯äº†</span><span class="dl">'</span><span class="p">)</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">Dog</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">age</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">Person</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">age</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// æ­¤æ–¹å¼ä¸æ¨è å­åŸå‹å’Œçˆ¶åŸå‹å…¬ç”¨åŒä¸€ä¸ªåŸå‹</span>
<span class="c1">// Dog.prototype = Person.prototype</span>
<span class="nx">Dog</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Person</span><span class="p">()</span>

<span class="kd">const</span> <span class="nx">d1</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Dog</span><span class="p">(</span><span class="dl">'</span><span class="s1">å¤§é»„</span><span class="dl">'</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="kd">const</span> <span class="nx">d2</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Dog</span><span class="p">(</span><span class="dl">'</span><span class="s1">å°é»„</span><span class="dl">'</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</code></pre></div></div>

<p><strong>ç¼ºç‚¹ï¼š</strong></p>

<ul>
  <li>è°ƒç”¨äº†ä¸¤æ¬¡çˆ¶ç±»ï¼Œäº§ç”Ÿäº†ä¸¤ä»½å®ä¾‹ã€‚</li>
</ul>

<h3 id="4-å¯„ç”Ÿå¼ç»„åˆç»§æ‰¿">4. å¯„ç”Ÿå¼ç»„åˆç»§æ‰¿</h3>

<p>é€šè¿‡ Object.create(æ•°æ®),å¯ä»¥åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡çš„åŸå‹æŒ‡å‘å‚æ•°å¯¹è±¡ã€‚</p>

<ul>
  <li>å³ç”¨æ„é€ å‡½æ•°ç»§æ‰¿å±æ€§ï¼Œåˆç”¨åŸå‹é“¾ç»§æ‰¿çš„æ–¹å¼ç»§æ‰¿æ–¹æ³•ã€‚</li>
  <li>æŠŠå­ç±»å‹çš„å¯¹è±¡æŒ‡å‘åˆ›å»ºçš„è¿™ä¸ªç©ºå¯¹è±¡ï¼Œè€Œç©ºå¯¹è±¡çš„åŸå‹å¯¹è±¡å°±æ˜¯åŸæ¥çˆ¶ç±»å‹ã€‚</li>
</ul>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// åˆ›å»ºäººçš„ç±»</span>
<span class="kd">function</span> <span class="nx">Person</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">age</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">age</span> <span class="o">=</span> <span class="nx">age</span>
<span class="p">}</span>

<span class="nx">Person</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">say</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">è¯´è¯äº†</span><span class="dl">'</span><span class="p">)</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">Dog</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">age</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">Person</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">age</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// æ­¤æ–¹å¼ä¸æ¨è å­åŸå‹å’Œçˆ¶åŸå‹å…¬ç”¨åŒä¸€ä¸ªåŸå‹</span>
<span class="c1">// Dog.prototype = Person.prototype</span>
<span class="nx">Dog</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">Person</span><span class="p">.</span><span class="nx">prototype</span><span class="p">)</span>

<span class="kd">const</span> <span class="nx">d1</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Dog</span><span class="p">(</span><span class="dl">'</span><span class="s1">å¤§é»„</span><span class="dl">'</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="kd">const</span> <span class="nx">d2</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Dog</span><span class="p">(</span><span class="dl">'</span><span class="s1">å°é»„</span><span class="dl">'</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="5-es6ç±»ç»§æ‰¿">5. ES6ç±»ç»§æ‰¿</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">Person</span> <span class="p">{</span>
  <span class="nx">say</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">è¯´è¯äº†</span><span class="dl">'</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nx">Child</span> <span class="kd">extends</span> <span class="nx">Person</span> <span class="p">{}</span>

<span class="kd">const</span> <span class="nx">child</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Child</span><span class="p">()</span>
<span class="nx">child</span><span class="p">.</span><span class="nx">say</span><span class="p">()</span>
</code></pre></div></div>

<h2 id="ä¸ƒæ·±æµ…æ‹·è´">ä¸ƒã€æ·±æµ…æ‹·è´</h2>

<h3 id="1-æµ…æ‹·è´">1. æµ…æ‹·è´</h3>

<ul>
  <li>åªèƒ½æ‹·è´å¯¹è±¡çš„ä¸€å±‚ã€‚</li>
  <li>å¦‚æœè¿›è¡Œæµ…æ‹·è´æ·±å±‚æ¬¡çš„å¼•ç”¨ç±»å‹çš„è¯ï¼Œå¦‚æœæ‹·è´ä¹‹åçš„æ•°æ®è¢«ä¿®æ”¹ï¼Œé‚£ä¹ˆåŸæ¥æ•°æ®ä¹Ÿä¼šè¢«ä¿®æ”¹ï¼Œå› ä¸ºä»–ä»¬éƒ½æ˜¯å¼•ç”¨çš„åŒä¸€ä¸ªå¯¹è±¡ã€‚</li>
</ul>

<ol>
  <li>` Object.assign({},obj)`  æµ…æ‹·è´</li>
  <li><code class="language-plaintext highlighter-rouge">...</code> æ‰©å±•è¿ç®—ç¬¦</li>
</ol>

<h3 id="2-æ·±æ‹·è´">2. æ·±æ‹·è´</h3>

<ol>
  <li>JSONå®ç°æ·±æ‹·è´</li>
</ol>

<ul>
  <li>JSON.stringifyï¼ˆï¼‰æŠŠå¯¹è±¡è½¬æ¢ä¸ºå­—ç¬¦ä¸²</li>
  <li>
    <p>JSON.parseï¼ˆï¼‰æŠŠå­—ç¬¦ä¸²è½¬å›å¯¹è±¡ã€‚</p>
  </li>
  <li>
    <p>é—®é¢˜ï¼š</p>

    <ul>
      <li>é€ æˆæ•°æ®ä¸¢å¤±å’Œæ•°æ®å¼‚å¸¸</li>
      <li>functionã€undefined ç›´æ¥ä¸¢å¤±</li>
      <li>NaNã€Infinityã€-Infinity å˜ä¸º null</li>
      <li>RegExpã€Error å¯¹è±¡åªå¾—åˆ°ç©ºå¯¹è±¡</li>
    </ul>
  </li>
</ul>

<ol>
  <li>å› æ­¤å¯ä»¥åœ¨é€šè¿‡é€’å½’æ·±æ‹·è´çš„æ—¶å€™éœ€è¦æŠŠå¯¹åº”ä¸¢å¤±çš„æ•°æ®ç±»å‹é‡æ–°new ä¹‹åå†è¿”å›ã€‚</li>
</ol>

<ul>
  <li>
    <p>é—®é¢˜ï¼š</p>

    <ul>
      <li>å¾ªç¯å¼•ç”¨é—®é¢˜ï¼šæ•°æ®å¯èƒ½æ˜¯åµŒå¥—å¼•ç”¨çš„ï¼Œé€ æˆå †æ ˆæº¢å‡ºçš„é—®é¢˜ã€‚</li>
    </ul>
  </li>
  <li>
    <p>è§£å†³ï¼š</p>

    <ul>
      <li>å°†æ¯æ¬¡æ‹·è´çš„æ•°æ®è¿›è¡Œ<strong>å­˜å‚¨</strong>ï¼Œæ¯æ¬¡åœ¨æ‹·è´ä¹‹å‰ï¼Œå…ˆçœ‹è¯¥æ•°æ®æ˜¯å¦æ‹·è´è¿‡ï¼Œå¦‚æœæ‹·è´è¿‡ï¼Œç›´æ¥ç”¨è¿™ä¸ªæ•°æ®ï¼Œä¸å†æ‹·è´ã€‚å¦‚æœæ²¡æœ‰æ‹·è´ï¼Œå¯¹è¯¥æ•°æ®è¿›è¡Œæ‹·è´å¹¶è®°å½•è¯¥æ•°æ®è®°å½•åˆ°å­˜å‚¨ä¸­ã€‚</li>
      <li>æ¯æ¬¡æ‹·è´çš„æ•°æ®å¯ä»¥ä½¿ç”¨æ•°ç»„è¿›è¡Œå­˜å‚¨ã€‚</li>
      <li>å¯ä»¥ç”¨mapè¿›è¡Œå­˜å‚¨ï¼Œä½†æ˜¯ä»–æ˜¯å¼ºå¼•ç”¨ç±»å‹ï¼Œæ— æ³•è¢«åƒåœ¾å›æ”¶ã€‚</li>
      <li>å¯ä»¥ä½¿ç”¨WeakMapï¼Œä»–æ˜¯å¼±å¼•ç”¨ç±»å‹ï¼Œå¯ä»¥è¢«åƒåœ¾å›æ”¶ã€‚</li>
    </ul>
  </li>
  <li>
    <p>åŒºåˆ«ï¼š</p>
  </li>
</ul>

<p><img src="https://cdn.jsdelivr.net/gh/TCIano/blog_img/%E6%B7%B1%E6%B5%85%E6%8B%B7%E8%B4%9D%E7%9A%84%E5%8C%BA%E5%88%AB.png" alt="æ·±æµ…æ‹·è´çš„åŒºåˆ«" /></p>

<h2 id="å…«new-çš„è¿‡ç¨‹">å…«ã€new çš„è¿‡ç¨‹</h2>

<ul>
  <li>åˆ›å»ºä¸€ä¸ªæ–°çš„ç©ºå¯¹è±¡</li>
  <li>å°†æ–°å¯¹è±¡çš„<code class="language-plaintext highlighter-rouge">__proto__</code> æŒ‡å‘æ„é€ å‡½æ•°çš„<code class="language-plaintext highlighter-rouge">prototype</code></li>
  <li>å°†æ„é€ å‡½æ•°å†…éƒ¨çš„ this æŒ‡å‘æ–°å¯¹è±¡</li>
  <li>æ‰§è¡Œæ„é€ å‡½æ•°ï¼Œç»™å®ä¾‹å¯¹è±¡æ·»åŠ å±æ€§å’Œæ–¹æ³•</li>
  <li>è¿”å› this
    <ul>
      <li>å¦‚æœæ‰‹åŠ¨è¿”å›ç®€å•æ•°æ®ç±»å‹ï¼Œé‚£ä¹ˆå¿½ç•¥ï¼Œæœ€ç»ˆè¿˜æ˜¯è¿”å› this</li>
      <li>å¦‚æœè¿”å›å¤æ‚æ•°æ®ç±»å‹ï¼Œé‚£ä¹ˆæœ€ç»ˆå¾—åˆ°è¯¥å¤æ‚æ•°æ®ç±»å‹ï¼Œthis æ— æ•ˆã€‚</li>
    </ul>
  </li>
</ul>

<h2 id="ä¹es6">ä¹ã€ES6</h2>

<h3 id="1letconst">1.letã€const</h3>

<ul>
  <li>let  ç”¨æ¥å£°æ˜å˜é‡</li>
  <li>const ç”¨æ¥å£°æ˜å¸¸é‡</li>
</ul>

<blockquote>
  <ol>
    <li>å…·æœ‰å—çº§ä½œç”¨åŸŸï¼Œåœ¨å—çº§ä½œç”¨åŸŸä¹‹å¤–è®¿é—®ä¸åˆ°ã€‚</li>
    <li>ä¸å­˜åœ¨å˜é‡æå‡ã€‚</li>
    <li>å…·æœ‰æš‚æ—¶æ€§æ­»åŒºï¼šåªè¦å—çº§ä½œç”¨åŸŸä¸­å£°æ˜äº†letæˆ–constï¼Œå°±ä¸ä¼šå—å¤–ç•Œå½±å“ï¼Œå¦‚æœåœ¨å£°æ˜ä¹‹å‰ä½¿ç”¨è¿™äº›å˜é‡æˆ–å¸¸é‡ ï¼Œå°±ä¼šæŠ¥é”™ã€‚</li>
    <li>ä¸å…è®¸é‡å¤å£°æ˜ã€‚</li>
  </ol>
</blockquote>

<h2 id="åå­—ç¬¦ä¸²æ–¹æ³•">åã€å­—ç¬¦ä¸²æ–¹æ³•</h2>

<h3 id="1-substr-å’Œ-substring">1. substr å’Œ substring</h3>

<ul>
  <li>substr ï¼ˆå¼€å§‹ç´¢å¼•ï¼Œé•¿åº¦ï¼‰ï¼šä»å¼€å§‹ç´¢å¼•æˆªå–å¯¹åº”é•¿åº¦ï¼ˆä¸åŒ…å«æœ€åå…ƒç´ ï¼‰ã€‚
    <ul>
      <li>ä¸ä¼ é€’ç¬¬äºŒä¸ªå‚æ•°ï¼šä»å¼€å§‹ç´¢å¼•æˆªå–åˆ°æœ€åã€‚</li>
      <li>ä¼ é€’ç¬¬äºŒä¸ªå‚æ•°ï¼šä»å¼€å§‹ç´¢å¼•æˆªå–å¯¹åº”é•¿åº¦ã€‚</li>
      <li>ç¬¬äºŒä¸ªå‚æ•°æ˜¯ <code class="language-plaintext highlighter-rouge">str.length</code> ï¼šè¡¨ç¤ºä»å¼€å§‹æˆªå–åˆ°æœ«å°¾ã€‚</li>
    </ul>
  </li>
  <li>substringï¼ˆå¼€å§‹ç´¢å¼•ï¼Œç»“æŸç´¢å¼•ï¼‰ï¼šä»å¼€å§‹ç´¢å¼•æˆªå–åˆ°ç»“æŸç´¢å¼•ï¼ˆä¸åŒ…å«æœ€åå…ƒç´ ï¼‰ã€‚
    <ul>
      <li>ä¸ä¼ é€’ç¬¬äºŒä¸ªå‚æ•°ï¼šä»å¼€å§‹æˆªå–åˆ°ç»“æŸã€‚</li>
      <li>ä¼ é€’ç¬¬äºŒä¸ªå‚æ•°ï¼šä»å¼€å§‹ç´¢å¼•æˆªå–åˆ°ç»“æŸç´¢å¼•ã€‚</li>
      <li>å¦‚æœå‚æ•°æ˜¯è´Ÿå€¼ï¼Œä»£è¡¨ç€å¾€å‰æ•°å‡ ä½ï¼Œå®ƒæ˜¯ä¸èƒ½å€’ç€å¼€å§‹æ•°çš„ã€‚æœ€åè¿”å›çš„æ˜¯ä¸€ä¸ªæˆªå–çš„æ–°æ•°ç»„ã€‚</li>
    </ul>
  </li>
</ul>

<h2 id="åä¸€æ•°ç»„æ–¹æ³•">åä¸€ã€æ•°ç»„æ–¹æ³•</h2>

<h2 id="åäºŒthisæŒ‡å‘">åäºŒã€thisæŒ‡å‘</h2>

<h3 id="1-å‡½æ•°æ¨¡å¼è°ƒç”¨">1. å‡½æ•°æ¨¡å¼è°ƒç”¨</h3>

<ul>
  <li>ï¼ˆå‡½æ•°ååŠ å°æ‹¬å·ç›´æ¥è°ƒç”¨ï¼‰ï¼ŒæŒ‡å‘ ${\textcolor{red}{Window}}$ã€‚</li>
</ul>

<h3 id="2-å¯¹è±¡æ¨¡å¼è°ƒç”¨">2. å¯¹è±¡æ¨¡å¼è°ƒç”¨</h3>

<ul>
  <li>è°è°ƒç”¨æŒ‡å‘è°ã€‚</li>
</ul>

<h3 id="3-ç®­å¤´å‡½æ•°">3. ç®­å¤´å‡½æ•°</h3>

<ul>
  <li>å’Œå®ƒçš„å®šä¹‰æœ‰å…³ï¼ŒæŒ‡å‘å®ƒçš„ä¸Šä¸‹æ–‡ã€‚</li>
</ul>

<h3 id="4-æ„é€ å‡½æ•°">4. æ„é€ å‡½æ•°</h3>

<ul>
  <li>é»˜è®¤æŒ‡å‘ ${\textcolor{red}{å®ä¾‹å¯¹è±¡}}$  ã€‚</li>
</ul>

<h3 id="5-ä¿®æ”¹thisæŒ‡å‘">5. ä¿®æ”¹thisæŒ‡å‘</h3>

<ul>
  <li><code class="language-plaintext highlighter-rouge">call(å®¿ä¸»å¯¹è±¡ï¼Œå‚æ•°1ï¼Œå‚æ•°2...)</code>
    <ul>
      <li>å®¿ä¸»å¯¹è±¡ï¼šå°†thisæŒ‡å‘å®¿ä¸»å¯¹è±¡ã€‚</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">apply(å®¿ä¸»å¯¹è±¡ï¼Œä¼ªæ•°ç»„)</code>
    <ul>
      <li>ä¸ºæ•°ç»„ä¸­æ”¾æƒ³è¦ä¼ é€’çš„å‚æ•°ã€‚</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">bind(å®¿ä¸»å¯¹è±¡ï¼Œå‚æ•°1ï¼Œå‚æ•°2...)</code>
    <ul>
      <li>ä¸ä¼šè‡ªåŠ¨è°ƒç”¨</li>
    </ul>
  </li>
</ul>

<p><img src="https://cdn.jsdelivr.net/gh/TCIano/blog_img/%E6%94%B9%E5%8F%98this%E6%8C%87%E5%90%91.png" alt="call apply bind" /></p>
:ET